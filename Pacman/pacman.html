<html>
<head>
	<style>
	*{padding: 0; margin:0;}
	canvas{ background: #000; display: block; margin: 0 auto;}
	</style>
</head>

<body>
<canvas id= "myCanvas" width="800" height="600"></canvas>
<script type="text/javascript">
var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");
document.addEventListener("keydown", keyDownHandler, false);
document.addEventListener("keyup", keyUpHandler, false);
var map = [
[4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,4,1,0,1,1,1,3,0,4,1,1,1,1,1,1,1,1,1,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,1,1,0,2,0,2,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,5,0,2,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,5,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],
[6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,5]
];
var ground = new Image();
ground.src = "tile092.png";
var wall1 = new Image();
wall1.src = "tile068.png";
var wall2 = new Image();
wall2.src = "tile069.png";
var wall3 = new Image();
wall3.src = "tile066.png";
var wall4= new Image();
wall4.src = "tile067.png";
var wall5 = new Image();
wall5.src = "tile065.png";
var wall6 = new Image();
wall6.src = "tile064.png";

var pacmanLeft1 = new Image();
pacmanLeft1.src = "tile048.png";
var pacmanLeft2 = new Image();
pacmanLeft2.src = "tile050.png";
var pacmanRight1 = new Image();
pacmanRight1.src = "tile052.png";
var pacmanRight2 = new Image();
pacmanRight2.src = "tile054.png";
var pacmanUp1 = new Image();
pacmanUp1.src = "tile049.png";
var pacmanUp2 = new Image();
pacmanUp2.src = "tile051.png";
var pacmanDown1 = new Image();
pacmanDown1.src = "tile053.png";
var pacmanDown2 = new Image();
pacmanDown2.src = "tile055.png";
var pacmanClosed = new Image();
pacmanClosed.src = "tile112.png";
var currentImage = new Image();
var timer = 0;
var upPressed = false;
var downPressed = false;
var leftPressed = false;
var rightPressed = false;
var collisionDetected = false;
var pRow = 1;
var pCol = 1;
var pX = 24;
var pY = 74;
var canMove = true;
var moveTimer = 0;
var animations = [];

function keyDownHandler(e){
	if(e.keyCode == 38)
	{
		upPressed = true;
	}
	if(e.keyCode == 40)
	{
		downPressed = true;
	}
	if(e.keyCode == 37)
	{
		leftPressed = true;
	}
	if(e.keyCode == 39)
	{
		rightPressed = true;
	}
	}
	
function keyUpHandler(e){
	if(e.keyCode == 38)
	{
		upPressed = false;
	}
	if(e.keyCode == 40)
	{
		downPressed = false;
	}
	if(e.keyCode == 37)
	{
		leftPressed = false;
	}
	if(e.keyCode == 39)
	{
		rightPressed = false;
	}
}

function Animation(sX, sY, dX, dY, direction)
{
this.sX = sX;
this.sY = sY;
this.dX = dX;
this.dY = dY;
this.dir = direction;
this.moved = 0;
}


function drawPacman2()
{
	moveTimer++;
	if(moveTimer > 48)
	{
		canMove = true;
	}
	if(upPressed)
	{
		if(map[pRow-1][pCol] == 0  && canMove)
		{
			pRow -= 1;
			moveTimer = 0;
			canMove = false;
			animations.push(new Animation(pRow, pCol, (pRow - 1), pCol, 0));
		}
	}
	else if(downPressed)
	{
		if(map[pRow + 1][pCol] == 0  && canMove)
		{
			pRow += 1;
			moveTimer = 0;
			canMove = false;
			animations.push(new Animation(pRow, pCol, (pRow + 1), pCol, 1));
		}
	}
	else if(leftPressed)
	{
		if(map[pRow][pCol - 1] == 0  && canMove)
		{
			pCol -= 1;
			moveTimer = 0;
			canMove = false;
			animations.push(new Animation(pRow, pCol, pRow, (pCol-1), 3));
			
		}
	}
	else if(rightPressed)
	{
		if(map[pRow ][pCol+ 1] == 0  && canMove)
		{
			pCol += 1;
			moveTimer = 0;
			canMove = false;
			animations.push(new Animation(pRow, pCol, pRow, (pCol+1), 2));
		}
	}
	var x = pCol * 24;
	var y = (pRow*24) + 50;
	if(canMove)
	{
		ctx.drawImage(currentImage, x, y);
	}
}


function drawAnimations()
{
	for(var i = 0; i < animations.length; i++)
	{
		
		if(animations[i].dir == 0)
		{
			if(moveTimer % 2 == 0)
			{
				pY -= 1;
			}
			///up
			ctx.drawImage(currentImage, pX, pY);
		}
		else if(animations[i].dir == 1)
		{
			//down
			if(moveTimer % 2 == 0)
			{
				pY += 1;
			}
			///up
			ctx.drawImage(currentImage, pX, pY);
		}
		else if(animations[i].dir == 2)
		{
			///right
			if(moveTimer % 2 == 0)
			{
				pX += 1;
			}
			///up
			ctx.drawImage(currentImage, pX, pY);
		}
		else if(animations[i].dir == 3)
		{
			///left
			if(moveTimer % 2 == 0)
			{
				pX -= 1;
			}
			///up
			ctx.drawImage(currentImage, pX, pY);
		}
	}
	if(moveTimer >= 47)
	{
		animations.pop();
	}
}

function drawPacman()
{
	
	if(leftPressed)
	{
		if(moveTimer > 36)
		{
			currentImage = pacmanClosed;
			///ctx.drawImage(pacmanClosed, pX, pY);
		}
		else if(moveTimer > 24)
		{
			currentImage = pacmanLeft1;
			///ctx.drawImage(pacmanLeft1, pX, pY);
		}
		else if(moveTimer > 12)
		{
			currentImage = pacmanLeft2;
			//ctx.drawImage(pacmanLeft2, pX, pY);
		}
		else
		{
			currentImage = pacmanLeft1;
			//ctx.drawImage(pacmanLeft1, pX, pY);
		}
	}
	else if(rightPressed)
	{
		if(moveTimer > 36)
		{
			currentImage =pacmanClosed;
			//ctx.drawImage(pacmanClosed, pX, pY);
		}
		else if(moveTimer > 24)
		{
			currentImage =pacmanRight1;
			//ctx.drawImage(pacmanRight1, pX, pY);
		}
		else if(moveTimer > 12)
		{
			currentImage =pacmanRight2;
			//ctx.drawImage(pacmanRight2, pX, pY);
		}
		else
		{
			currentImage =pacmanRight1;
			//ctx.drawImage(pacmanRight1, pX, pY);
		}
	}
	else if(upPressed)
	{
		if(moveTimer > 36)
		{
			currentImage =pacmanClosed;
			//ctx.drawImage(pacmanClosed, pX, pY);
		}
		else if(moveTimer > 24)
		{
			currentImage =pacmanUp1;
			//ctx.drawImage(pacmanUp1, pX, pY);
		}
		else if(moveTimer > 12)
		{
			currentImage =pacmanUp2;
			//ctx.drawImage(pacmanUp2, pX, pY);
		}
		else
		{
			currentImage =pacmanUp1;
			//ctx.drawImage(pacmanUp1, pX, pY);
		}
	}
	else if(downPressed)
	{
		if(moveTimer > 36)
		{
			currentImage =pacmanClosed;
			///ctx.drawImage(pacmanClosed, pX, pY);
		}
		else if(moveTimer > 24)
		{
			currentImage =pacmanDown1;
			//ctx.drawImage(pacmanDown1, pX, pY);
		}
		else if(moveTimer > 12)
		{
			currentImage =pacmanDown2;
			//ctx.drawImage(pacmanDown2, pX, pY);
		}
		else
		{
			currentImage =pacmanDown1;
			//ctx.drawImage(pacmanDown1, pX, pY);
		}
	}
	else
	{
		currentImage =pacmanClosed;
		///ctx.drawImage(pacmanClosed, pX, pY);
	}
}

function drawMap()
{
	for(var i = 0; i < map.length; i++)
	{
		for(var j = 0; j < map[i].length; j++)
		{
			var x = j * 24;
			var y = (i*24) + 50;
			if(map[i][j] == 0)
			{
				ctx.drawImage(ground, x, y);
			}
			else if(map[i][j] == 1)
			{
				ctx.drawImage(wall6, x, y);
			}
			else if(map[i][j] == 2)
			{
				ctx.drawImage(wall5, x, y);
			}
			else if(map[i][j] == 3)
				{
					ctx.drawImage(wall2, x, y);
				}
			else if(map[i][j] == 4)
				{
					ctx.drawImage(wall1, x, y);
				}
			
			else if(map[i][j] == 5)
				{
					ctx.drawImage(wall4, x, y);
				}
		
			else if(map[i][j] == 6)
				{
					ctx.drawImage(wall3, x, y);
				}
		}
		}
	}



function draw()
{
	ctx.clearRect(0,0,800,600);	
	drawPacman();
	drawPacman2();
	drawMap();
	drawAnimations();
}

setInterval(draw, 10);


</script>
</body>
</html>